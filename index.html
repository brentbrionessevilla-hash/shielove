<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width,initial-scale=1" />
		<title>Falling "iloveyou"</title>
		<style>
			:root{--bg:#0b1020;--fg:#ffd1dc;--accent:#ff6b9a}
			html,body{height:100%;margin:0}
			body{background:linear-gradient(180deg,#071025,#0b1020);color:var(--fg);font-family:Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;overflow:hidden;display:flex;align-items:center;justify-content:center}
			.stage{position:relative;width:100%;height:100vh;overflow:hidden}
			.letter{position:absolute;top:-10vh;will-change:transform,opacity;pointer-events:none;user-select:none;display:inline-block;text-shadow:0 2px 8px rgba(0,0,0,.6);}
			@keyframes fall{
				0%{transform:translateY(-10vh) rotate(var(--r,0deg));opacity:1}
				90%{opacity:1}
				100%{transform:translateY(110vh) rotate(calc(var(--r,0deg) + 180deg));opacity:0}
			}
			.controls{position:fixed;left:12px;top:12px;background:rgba(255,255,255,0.06);border-radius:10px;padding:8px 10px;color:var(--fg);backdrop-filter: blur(6px);display:flex;gap:8px;align-items:center}
			.btn{background:transparent;border:1px solid rgba(255,255,255,0.08);color:var(--fg);padding:6px 10px;border-radius:6px;cursor:pointer}
			.title{position:fixed;left:12px;bottom:12px;color:rgba(255,255,255,0.6);font-size:14px}
			/* heart style for the special heart element */
			.heart{color:var(--accent);filter:drop-shadow(0 4px 12px rgba(255,107,154,0.25))}
			/* prefers-reduced-motion: reduce animations and spawn fewer items */
			@media (prefers-reduced-motion: reduce){
				.letter{animation:none !important;opacity:1}
			}
		</style>
	</head>
	<body>
		<div class="stage" id="stage" aria-hidden="false"></div>

		<div class="controls" aria-hidden="false">
			<button class="btn" id="toggle">Pause</button>
			<button class="btn" id="clear">Clear</button>
		</div>

		<div class="title">Falling "iloveyou" — hearts & letters</div>

		<script>
			(function(){
				const stage = document.getElementById('stage');
				const toggle = document.getElementById('toggle');
				const clear = document.getElementById('clear');
				const word = 'iloveyou';
				const heartChar = '❤';
				let running = true;
				let intervalId = null;
				const prefersReduced = window.matchMedia('(prefers-reduced-motion: reduce)').matches;

				function rand(min, max){ return Math.random() * (max - min) + min }

				function makeLetter(ch, isHeart=false){
					const el = document.createElement('span');
					el.className = 'letter';
					// allow HTML so we can optionally include a colored heart span
					el.innerHTML = ch;
					el.setAttribute('aria-hidden','true');

					// randomize starting horizontal position, font size, rotation and animation speed
					const left = rand(3, 92);
					  const size = Math.round(rand(28, 86));
					  const rotation = Math.round(rand(-20,20));
					  const duration = Math.round(rand(7, 12));
					const delay = Math.round(rand(0, 4000));

					el.style.left = left + '%';
					el.style.fontSize = size + 'px';
					el.style.setProperty('--r', rotation + 'deg');
					if(!prefersReduced){
						el.style.animation = `fall ${duration}s linear ${delay}ms forwards`;
					}

					// slight wiggle using transition on transform when prefReduced motion
					if(prefersReduced){
						el.style.transition = 'transform 10s linear, opacity 10s linear';
						// drop straight down more slowly
						setTimeout(()=>{
							el.style.transform = 'translateY(80vh)';
							el.style.opacity = '0';
						}, 100);
						setTimeout(()=> el.remove(), 11000);
					} else {
						el.addEventListener('animationend', ()=> el.remove(), {once:true});
					}

					return el;
				}

				function spawn(){
					// spawn the full word; occasionally attach a heart
					const makeHeart = Math.random() < 0.12; // 12% chance
					const content = makeHeart ? `${word} <span class="heart">${heartChar}</span>` : word;
					const node = makeLetter(content, makeHeart);
					stage.appendChild(node);
				}

				function startSpawning(){
					if(intervalId) return;
					// spawn frequency depends on reduced-motion
					const frequency = prefersReduced ? 1200 : 320; // ms
					intervalId = setInterval(()=>{ if(running) spawn() }, frequency);
				}

				function stopSpawning(){
					if(intervalId){ clearInterval(intervalId); intervalId = null }
				}

				toggle.addEventListener('click', ()=>{
					running = !running;
					toggle.textContent = running ? 'Pause' : 'Play';
					// pause/resume animations via animationPlayState
					document.querySelectorAll('.letter').forEach(el=>{
						el.style.animationPlayState = running ? 'running' : 'paused';
						el.style.webkitAnimationPlayState = running ? 'running' : 'paused';
					});
				});

				clear.addEventListener('click', ()=>{
					document.querySelectorAll('.letter').forEach(el=>el.remove());
				});

				// start
				startSpawning();

				// accessibility: if reduced motion, make controls visible and default to paused spawn after initial short bursts
				if(prefersReduced){
					// spawn a small handful then pause
					setTimeout(()=>{ running = false; toggle.textContent = 'Play' }, 3000);
				}

				// expose small API for debugging
				window._love = {spawn, startSpawning, stopSpawning};
			})();
		</script>
	</body>
</html>

